{% extends "base.html" %}
{% load static %}
{% block title %}Shipping History{% endblock %}

{% block content %}
<!-- DataTables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css"/>

<div class="container-fluid mt-4">
    <div class="card shadow-sm">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4 class="card-title mb-0">Riwayat Pengiriman (Shipping History)</h4>
                <a href="{% url 'scanshipping' %}" class="btn btn-secondary">
                    <i class="bi bi-arrow-left me-1"></i> Kembali ke Scan Shipping
                </a>
            </div>

            <table id="shippingHistoryTable" class="table table-striped dt-responsive nowrap" style="width:100%">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Waktu Ship</th>
                        <th>ID Pesanan</th>
                        <th>User</th>
                        <th>Kurir</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_script %}
<!-- DataTables JS Core -->
<script type="text/javascript" src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
<script type="text/javascript" src=""></script>
<!-- DataTables Responsive JS -->
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>

<script>
$(document).ready(function() {
    $('#shippingHistoryTable').DataTable({
        "responsive": true,
        "processing": true,
        "serverSide": true,
        "ajax": "{% url 'shipping_history_api' %}",
        "pageLength": 50,
        "order": [[ 1, "desc" ]],
        "columns": [
            { "data": "id" },
            { "data": "waktu_ship" },
            { "data": "order_id_pesanan" },
            { "data": "user" },
            { "data": "kurir" }
        ],
        "columnDefs": [
            {
                "targets": [1], 
                "render": function ( data, type, row ) {
                    if (data) {
                        const date = new Date(data);
                        return date.toLocaleString('id-ID', {
                            year: 'numeric', month: 'short', day: '2-digit',
                            hour: '2-digit', minute: '2-digit', second: '2-digit',
                            timeZone: 'Asia/Jakarta'
                        });
                    }
                    return 'N/A';
                }
            }
        ]
    });
});
</script>
{% endblock %} 